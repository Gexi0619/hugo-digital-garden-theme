{{- /* Grid display mode â€” two-column cards
     Receives: dict "pages" $pages "show" (slice) "tags_key" (string) "id" (string)
     show options: "summary", "tags", "date", "lastmod", "status", "image", "ping"
*/ -}}
{{- $tagsKey := .tags_key -}}
{{- $show := .show | default (slice "summary" "tags" "date" "status" "image") -}}
<div class="row row-cols-2 g-2{{ with .id }} mb-5" id="{{ . }}{{ end }}">
	{{ range .pages }}
	{{- $isoClasses := "" -}}
	{{- if $tagsKey -}}
		{{- range index .Params $tagsKey -}}
			{{- $isoClasses = printf "%s js-iso-%s" $isoClasses (. | urlize) -}}
		{{- end -}}
	{{- end -}}
	<div class='col{{ $isoClasses }}'>
		<div class="card top-highlight">
			{{ if in $show "image" }}
			{{ $img := (.Resources.ByType "image").GetMatch "*featured*" }}
			{{ if $img }}
			{{ $img = $img.Fit "500x500" }}
			{{ with $img }}
			<img src="{{ .Permalink }}" alt="{{ $.Title }}" class="card-img-top p-3">
			{{ end }}
			{{ end }}
			{{ end }}
			<div class="card-body">
				<div style="display: flex; justify-content: space-between; align-items: center;">
					<h5 class="card-title" style="margin-bottom: 0.3rem;">{{ .Title }}</h5>
					{{ if and (in $show "ping") .Params.ping }}<i class="fas fa-thumbtack" style="color: #ccc; font-size: 0.8rem;"></i>{{ end }}
				</div>
				{{ if in $show "summary" }}<p class="card-text" style="margin-bottom: 0.25rem;">{{ .Summary }}</p>{{ end }}
				<a href="{{ .Permalink }}" class="stretched-link"></a>
				<div class="row justify-content-between" style="flex-wrap: wrap; gap: 0;">
					{{ if in $show "tags" }}
					<div class="col-12 mb-0">
					{{ with index .Params ($tagsKey | default "tags") }}
					{{ range . }}<a href="{{ (printf "/tags/%s/" (urlize .)) | relURL }}" class="tag-link">#{{ . }}</a>{{ end }}
					{{ end }}
					</div>
					{{ end }}
					{{ if or (in $show "date") (in $show "lastmod") }}
					<div class="col-auto align-self-center">
						{{ $dateFormat := .Site.Params.dateFormat | default "Jan 2, 2006" }}
						{{ if in $show "date" }}
						<span style="font-size: small">{{ .Date.Format $dateFormat }}</span>
						{{ end }}
						{{ if in $show "lastmod" }}
						<span style="font-size: small">{{ .Lastmod.Format $dateFormat }}</span>
						{{ end }}
					</div>
					{{ end }}
					{{ if in $show "status" }}
					<div class="col-auto align-self-end" style="text-align: right">
						{{ partial "status.html" . }}
					</div>
					{{ end }}
				</div>
			</div>
		</div>
	</div>
	{{ end }}
</div>
