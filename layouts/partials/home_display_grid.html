{{- /* Grid display mode â€” two-column cards with optional image, title, summary, tags, date, status
     Receives: dict "pages" $pages "tags_key" "project_tags" (optional, for isotope filtering)
*/ -}}
{{- $tagsKey := .tags_key -}}
<div class="row row-cols-2 g-2{{ with .id }} mb-5" id="{{ . }}{{ end }}">
	{{ range .pages }}
	{{- $isoClasses := "" -}}
	{{- if $tagsKey -}}
		{{- range index .Params $tagsKey -}}
			{{- $isoClasses = printf "%s js-iso-%s" $isoClasses . -}}
		{{- end -}}
	{{- end -}}
	<div class='col{{ $isoClasses }}'>
		<div class="card top-highlight">
			{{ $img := (.Resources.ByType "image").GetMatch "*featured*" }}
			{{ if $img }}
			{{ $img = $img.Fit "500x500" }}
			{{ with $img }}
			<img src="{{ .Permalink }}" alt="{{ $.Title }}" class="card-img-top p-3">
			{{ end }}
			{{ end }}
			<div class="card-body">
				<h5 class="card-title">{{ .Title }}</h5>
				<p class="card-text">{{ .Summary }}</p>
				<a href="{{ .Permalink }}" class="stretched-link"></a>
				<div class="row justify-content-between" style="flex-wrap: wrap;">
					<div class="col-12 mb-1">
					{{- if $tagsKey -}}
					{{ with index .Params $tagsKey }}
					{{ range . }}
					<span class="badge tag-badge">{{ . }}</span>
					{{ end }}
					{{ end }}
					{{- else -}}
					{{ with .Params.project_tags }}
					{{ range . }}
					<span class="badge tag-badge">{{ . }}</span>
					{{ end }}
					{{ end }}
					{{ with .Params.garden_tags }}
					{{ range . }}
					<span class="badge tag-badge">{{ . }}</span>
					{{ end }}
					{{ end }}
					{{- end -}}
					</div>
					<div class="col-auto align-self-center">
						{{ $dateFormat := .Site.Params.dateFormat | default "Jan 2, 2006" }}
						<span style="font-size: small">{{ .Date.Format $dateFormat }}</span>
					</div>
					<div class="col-auto align-self-end" style="text-align: right">
						{{ partial "status.html" . }}
					</div>
				</div>
			</div>
		</div>
	</div>
	{{ end }}
</div>
