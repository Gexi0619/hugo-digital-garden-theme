{{- /* Unified home section partial
     Receives: dict "ctx" $ "name" .name "limit" .limit "display" .display
     display: "list" | "grid" | "full"
     Falls back to home_section_<name>.html if display is not set
*/ -}}

{{- $ctx := .ctx -}}
{{- $name := .name -}}
{{- $limit := .limit -}}
{{- $display := .display -}}

{{- /* If no display mode specified, fall back to section-specific partial */ -}}
{{ if not $display }}
	{{ partial (printf "home_section_%s.html" $name) (dict "ctx" $ctx "limit" $limit) }}
{{ else }}
<section class="home-section">
	{{- with $ctx.Site.GetPage "section" $name -}}
	<div class="pb-3">
		<a class="heading fs-2" href="{{ .RelPermalink }}">{{ .Title }}
		{{- if ne $display "full" }} <span class="section-count">({{ len .RegularPages }})</span>{{ end -}}
		</a>
	</div>
	{{ if .Summary }}<p class="subheading">{{ .Summary }}</p>{{ end }}
	{{- end -}}

	{{- $pages := where $ctx.Site.RegularPages "Section" $name | first $limit -}}

	{{ if eq $display "list" }}
		{{ partial "home_display_list.html" (dict "pages" $pages) }}
	{{ else if eq $display "grid" }}
		{{ partial "home_display_grid.html" (dict "pages" $pages) }}
	{{ else if eq $display "full" }}
		{{ partial "home_display_full.html" (dict "pages" $pages) }}
	{{ end }}
</section>
{{ end }}
