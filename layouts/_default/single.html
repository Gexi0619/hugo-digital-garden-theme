{{ define "main" }}

<div class="page-wrapper page-wrapper--narrow">
    {{ partial "breadcrumb.html" . }}
    <div class="py-4">
        <h1 class="display-2 mb-4 text-center">{{ .Title }}</h1>
        {{ with .Summary }}
        <p class="text-center single-summary">{{ . }}</p>
        {{ end }}
        <div class="text-center pt-1">
            {{ with .Params.links }}
            {{ range sort . "weight" }}
            {{ $linkClass := "btn btn-sm btn-link mx-2" }}
            {{ if eq $.Section "projects" }}
            {{ $linkClass = "btn btn-sm btn-link btn-link-title mx-2" }}
            {{ end }}
            <a href="{{ .href }}" role="button" class="{{ $linkClass }}" target="_blank">
                <i class="{{ .icon }}"></i>
            {{ .text }}
            </a>
            {{ end }}
            {{ end }}
        </div>
    </div>
    <div class="mb-4">
        <p class="single-date m-0">
            {{ $dateFormat := .Site.Params.dateFormat | default "Jan 2, 2006" }}
            {{ with .Date }}
                Created {{ .Format $dateFormat }} -
            {{ end }}
            Last updated: {{ .Lastmod.Format $dateFormat }}
        </p>
        <hr class="dropdown-divider">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                {{ with .Params.tags }}
                {{ range . }}
                <a href="{{ (printf "/tags/%s/" (urlize .)) | relURL }}" class="tag-link">#{{ . }}</a>
                {{ end }}
                {{ end }}
            </div>
            <div>
                {{ partial "status.html" . }}
            </div>
        </div>
    </div>

    <div class="body-text main-content">
        {{ .Content | safeHTML }}
    </div>

    {{/* Prev/Next navigation based on parent section order */}}
    {{ $pages := .Parent.Pages }}
    {{ $currentIndex := 0 }}
    {{ range $i, $p := $pages }}
        {{ if eq $p.File.UniqueID $.File.UniqueID }}
            {{ $currentIndex = $i }}
        {{ end }}
    {{ end }}
    {{ $prev := false }}
    {{ $next := false }}
    {{ if gt $currentIndex 0 }}
        {{ $prev = index $pages (sub $currentIndex 1) }}
    {{ end }}
    {{ if lt (add $currentIndex 1) (len $pages) }}
        {{ $next = index $pages (add $currentIndex 1) }}
    {{ end }}
    {{ if or $prev $next }}
    <nav class="prev-next-nav">
        <div class="prev-next-item prev-next-prev">
            {{ with $prev }}
            <a href="{{ .Permalink }}"><span class="prev-next-arrow">&larr;</span><span class="prev-next-title">{{ .Title }}</span></a>
            {{ end }}
        </div>
        <div class="prev-next-item prev-next-next">
            {{ with $next }}
            <a href="{{ .Permalink }}"><span class="prev-next-title">{{ .Title }}</span><span class="prev-next-arrow">&rarr;</span></a>
            {{ end }}
        </div>
    </nav>
    {{ end }}
</div>

{{ end }}