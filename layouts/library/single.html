{{ define "main" }}

<!-- Title and summary -->

<div class="page-wrapper page-wrapper--narrow mt-5 library-single">
    {{ partial "breadcrumb.html" . }}
    <div class="row justify-content-center g-4">
        <div class="col-xs-12 col-sm-4">
            {{ $img := (.Resources.ByType "image").GetMatch "*featured*" }}
            {{ $img = $img.Fit "400x500" }}
            {{ with $img }}
            <div class="text-center">
                <img src="{{ .Permalink }}" class="rounded card-img-top" style="max-width: 250px;">
            </div>
            {{ end }}
        </div>
        <div class="col-sm-7">
            {{ if .Summary | safeHTML }}
            <h4 class="card-title display-2">{{ .Title }}</h4>
            <p class="fs-2 pb-3">{{ .Summary }}</p>
            {{ else }}
            <h4 class="card-title display-2 pb-3">{{ .Title }}</h4>
            {{ end }}
            <p>
                <figcaption class="blockquote-footer fs-5">
                  {{ .Params.Author}}
                </figcaption>
              </p>
        </div>
    </div>

    <div class="main-content py-5">
        {{ .Content | markdownify | safeHTML }}
    </div>

    {{/* Prev/Next navigation based on parent section order */}}
    {{ $pages := .Parent.Pages }}
    {{ $currentIndex := 0 }}
    {{ range $i, $p := $pages }}
        {{ if eq $p.File.UniqueID $.File.UniqueID }}
            {{ $currentIndex = $i }}
        {{ end }}
    {{ end }}
    {{ $prev := false }}
    {{ $next := false }}
    {{ if gt $currentIndex 0 }}
        {{ $prev = index $pages (sub $currentIndex 1) }}
    {{ end }}
    {{ if lt (add $currentIndex 1) (len $pages) }}
        {{ $next = index $pages (add $currentIndex 1) }}
    {{ end }}
    {{ if or $prev $next }}
    <nav class="prev-next-nav">
        <div class="prev-next-item prev-next-prev">
            {{ with $prev }}
            <a href="{{ .Permalink }}"><span class="prev-next-arrow">&larr;</span><span class="prev-next-title">{{ .Title }}</span></a>
            {{ end }}
        </div>
        <div class="prev-next-item prev-next-next">
            {{ with $next }}
            <a href="{{ .Permalink }}"><span class="prev-next-title">{{ .Title }}</span><span class="prev-next-arrow">&rarr;</span></a>
            {{ end }}
        </div>
    </nav>
    {{ end }}
</div>
{{ end }}